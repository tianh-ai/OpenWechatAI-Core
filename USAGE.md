# å¾®ä¿¡è‡ªåŠ¨åŒ–é€šä¿¡ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## âœ… å·²å®ç°åŠŸèƒ½

1. **æ¶ˆæ¯å‘é€** - è‡ªåŠ¨å‘é€æ–‡å­—æ¶ˆæ¯
2. **æ¶ˆæ¯æ¥æ”¶** - ç›‘æ§å¹¶æ£€æµ‹æ–°æ¶ˆæ¯
3. **è‡ªåŠ¨å›å¤** - æ”¶åˆ°æ¶ˆæ¯åè‡ªåŠ¨å›å¤
4. **è”ç³»äººç®¡ç†** - æœç´¢å¹¶æ‰“å¼€æŒ‡å®šè”ç³»äººèŠå¤©çª—å£
5. **æ™ºèƒ½å›å¤è§„åˆ™** - åŸºäºé…ç½®æ–‡ä»¶çš„æ¡ä»¶å›å¤ç³»ç»Ÿ
6. **å¤šè”ç³»äººç›‘æ§** - åŒæ—¶ç®¡ç†å¤šä¸ªèŠå¤©ä¼šè¯

## ğŸ“‹ å‰ç½®è¦æ±‚

### 1. ç¡¬ä»¶é…ç½®
- Android æ‰‹æœºï¼ˆå·²æµ‹è¯•ï¼šRedmi 24094RAD4Cï¼ŒAndroid 15ï¼‰
- USB æ•°æ®çº¿è¿æ¥ç”µè„‘
- å¼€å¯ USB è°ƒè¯•æ¨¡å¼

### 2. å¾®ä¿¡è®¾ç½®
âš ï¸ **é‡è¦**ï¼šå¿…é¡»åœ¨å¾®ä¿¡ä¸­è¿›è¡Œä»¥ä¸‹è®¾ç½®ï¼š

1. æ‰“å¼€å¾®ä¿¡
2. è¿›å…¥ **æˆ‘ â†’ è®¾ç½® â†’ èŠå¤©**
3. æ‰¾åˆ° **å›è½¦é”®å‘é€æ¶ˆæ¯**
4. **å¼€å¯æ­¤é€‰é¡¹** âœ…

### 3. Python ç¯å¢ƒ
```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate

# å·²å®‰è£…ä¾èµ–
pip install uiautomator2 imagehash pillow
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å‘é€å•æ¡æ¶ˆæ¯

```bash
# ç¡®ä¿æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹èŠå¤©çª—å£å·²æ‰“å¼€
python wechat_sender.py "ä½ å¥½ï¼Œè¿™æ˜¯æµ‹è¯•æ¶ˆæ¯"
```

### 2. æ¥æ”¶æ¶ˆæ¯æµ‹è¯•

```bash
# è¿è¡Œååœ¨æ‰‹æœºä¸Šå‘é€æ¶ˆæ¯
python wechat_receiver.py
```

### 3. è‡ªåŠ¨å›å¤ï¼ˆæ™ºèƒ½è§„åˆ™æ¨¡å¼ï¼‰â­ æ¨è

```bash
# ä½¿ç”¨è§„åˆ™å¼•æ“è‡ªåŠ¨å›å¤ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰
python wechat_auto_reply.py

# è‡ªå®šä¹‰æ£€æŸ¥é—´éš”
python wechat_auto_reply.py --interval 5
```

### 4. æ‰“å¼€æŒ‡å®šè”ç³»äººèŠå¤©çª—å£

```bash
# æ‰“å¼€æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹
python wechat_contact_manager.py "æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹"

# æ‰“å¼€å…¶ä»–è”ç³»äºº
python wechat_contact_manager.py "å¼ ä¸‰"
```

### 5. å¤šè”ç³»äººç›‘æ§

```bash
# åŒæ—¶ç›‘æ§å¤šä¸ªè”ç³»äºº
python examples/multi_contact_demo.py
```

### 6. è§„åˆ™å¼•æ“æµ‹è¯•

```bash
# æµ‹è¯•å›å¤è§„åˆ™
python reply_rule_engine.py
```

## ğŸ“ Python API ä½¿ç”¨

### å‘é€æ¶ˆæ¯

```python
from wechat_sender import WeChatSender

sender = WeChatSender()

# å‘é€æ¶ˆæ¯
sender.send_message("ä½ å¥½")

# å‘é€æ¶ˆæ¯å¹¶ä¿å­˜æˆªå›¾
sender.send_message("ä½ å¥½", screenshot_dir="screenshots/my_send")
```

### æ¥æ”¶æ¶ˆæ¯

```python
from wechat_receiver import WeChatReceiver

receiver = WeChatReceiver()

# ç­‰å¾…æ–°æ¶ˆæ¯ï¼ˆ30ç§’è¶…æ—¶ï¼‰
if receiver.wait_for_new_message(timeout=30):
    # è·å–æ¶ˆæ¯æˆªå›¾
    msg_path = receiver.get_latest_message_screenshot()
    print(f"æ”¶åˆ°æ¶ˆæ¯: {msg_path}")
```

### è‡ªåŠ¨å›å¤

```python
from wechat_auto_reply import WeChatAutoReply

# å¯ç”¨è§„åˆ™å¼•æ“çš„è‡ªåŠ¨å›å¤
auto_reply = WeChatAutoReply(use_rules=True)
auto_reply.start_monitoring(check_interval=3)
```

### è”ç³»äººç®¡ç†

```python
from wechat_contact_manager import WeChatContactManager

manager = WeChatContactManager()

# æ‰“å¼€æŒ‡å®šè”ç³»äººçš„èŠå¤©çª—å£
manager.open_chat_window("æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹")

# æˆªå›¾å½“å‰èŠå¤©çª—å£
manager.screenshot_chat_window("my_screenshot.jpg")
```

### æ™ºèƒ½å›å¤è§„åˆ™

```python
from reply_rule_engine import ReplyRuleEngine

engine = ReplyRuleEngine()

# åŒ¹é…è§„åˆ™å¹¶è·å–å›å¤
message_info = {"type": "text", "content": "ä½ å¥½"}
reply = engine.match_rule(message_info, contact_name="å¼ ä¸‰")
print(reply)  # è¾“å‡º: ä½ å¥½ï¼æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ

# é‡æ–°åŠ è½½è§„åˆ™ï¼ˆçƒ­æ›´æ–°ï¼‰
engine.reload_rules()
```

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: è¾“å…¥æ³•è¢«æ”¹å˜äº†
**åŸå› **: uiautomator2 ä¼šè‡ªåŠ¨åˆ‡æ¢è¾“å…¥æ³•

**è§£å†³**: è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶æ¢å¤ç™¾åº¦è¾“å…¥æ³•ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ

### Q2: å‘é€åæ²¡ååº”
**æ£€æŸ¥æ¸…å•**:
- âœ… å¾®ä¿¡è®¾ç½®ä¸­æ˜¯å¦å¼€å¯äº†"å›è½¦é”®å‘é€æ¶ˆæ¯"
- âœ… è¾“å…¥æ³•æ˜¯å¦æ­£å¸¸ï¼ˆä¸æ˜¯ AdbKeyboardï¼‰
- âœ… èŠå¤©çª—å£æ˜¯å¦å·²æ‰“å¼€

### Q3: æ£€æµ‹ä¸åˆ°æ–°æ¶ˆæ¯
**æ£€æŸ¥**:
- èŠå¤©çª—å£å¿…é¡»ä¿æŒæ‰“å¼€çŠ¶æ€
- æ¶ˆæ¯å·®å¼‚é˜ˆå€¼å¯èƒ½éœ€è¦è°ƒæ•´ï¼ˆåœ¨ `_has_new_message()` ä¸­ä¿®æ”¹ï¼‰

### Q4: å›è½¦é”®å‘é€ä¸äº†
**è§£å†³**: 
1. ç¡®è®¤å¾®ä¿¡è®¾ç½®ä¸­å·²å¼€å¯"å›è½¦é”®å‘é€æ¶ˆæ¯"
2. é‡å¯å¾®ä¿¡
3. é‡æ–°è¿è¡Œè„šæœ¬

## ğŸ“¸ æˆªå›¾è¯´æ˜

æ‰€æœ‰æ“ä½œéƒ½ä¼šè‡ªåŠ¨ä¿å­˜æˆªå›¾åˆ° `screenshots/` ç›®å½•ï¼š

```
screenshots/
â”œâ”€â”€ send_message/          # å‘é€æ¶ˆæ¯æˆªå›¾
â”‚   â”œâ”€â”€ 01_cleared.jpg     # æ¸…ç©ºè¾“å…¥æ¡†
â”‚   â”œâ”€â”€ 02_typed.jpg       # è¾“å…¥æ–‡å­—
â”‚   â””â”€â”€ 03_sent.jpg        # å‘é€å
â”œâ”€â”€ auto_reply/            # è‡ªåŠ¨å›å¤æˆªå›¾
â”‚   â”œâ”€â”€ msg_1.jpg          # æ”¶åˆ°çš„æ¶ˆæ¯
â”‚   â””â”€â”€ reply_1/           # å›å¤æˆªå›¾
â””â”€â”€ test/                  # æµ‹è¯•æˆªå›¾
```

## ğŸ”® ä¸‹ä¸€æ­¥è®¡åˆ’

- [x] é›†æˆ OCR è¯†åˆ«æ¶ˆæ¯å†…å®¹
- [x] æ™ºèƒ½å›å¤è§„åˆ™å¼•æ“
- [x] å¤šè”ç³»äººç®¡ç†
- [ ] æ¥å…¥ ChatGPT/Claude API æ™ºèƒ½å›å¤
- [ ] æ”¯æŒå‘é€å›¾ç‰‡ã€è¡¨æƒ…
- [ ] æ·»åŠ æ¶ˆæ¯å†…å®¹æ•°æ®åº“
- [ ] Web ç®¡ç†ç•Œé¢
- [ ] æ¶ˆæ¯å†å²è®°å½•æŸ¥è¯¢

## ğŸ“ å›å¤è§„åˆ™é…ç½®

è§„åˆ™é…ç½®æ–‡ä»¶ä½äº `config/reply_rules.yaml`ï¼Œæ”¯æŒä»¥ä¸‹åŠŸèƒ½ï¼š

### æ—¶é—´æ®µè§„åˆ™
```yaml
- name: "å·¥ä½œæ—¶é—´å›å¤"
  conditions:
    time_range:
      - start: "09:00"
        end: "18:00"
    weekdays: [1, 2, 3, 4, 5]  # å‘¨ä¸€åˆ°å‘¨äº”
  actions:
    - type: "reply"
      message: "æ”¶åˆ°æ‚¨çš„æ¶ˆæ¯ï¼Œå·¥ä½œæ—¶é—´ä¼šå°½å¿«å›å¤ï¼"
```

### å…³é”®è¯è§„åˆ™
```yaml
- name: "é—®å€™è¯­è¯†åˆ«"
  conditions:
    keywords:
      - pattern: "ä½ å¥½|æ‚¨å¥½|hello"
        reply: "ä½ å¥½ï¼æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ"
```

### è”ç³»äººè§„åˆ™
```yaml
- name: "VIPå®¢æˆ·"
  conditions:
    contacts:
      - "å¼ æ€»"
      - "æç»ç†"
  actions:
    - type: "reply"
      message: "æ‚¨å¥½ï¼æˆ‘ä¼šä¼˜å…ˆå¤„ç†æ‚¨çš„æ¶ˆæ¯"
```

### æ¶ˆæ¯ç±»å‹è§„åˆ™
```yaml
- name: "è¯­éŸ³æ¶ˆæ¯"
  conditions:
    message_type: "voice"
  actions:
    - type: "reply"
      message: "æ”¶åˆ°æ‚¨çš„è¯­éŸ³ï¼Œè¯·ç¨åå›å¤"
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä½¿ç”¨é£é™©è‡ªè´Ÿ** - æ­¤å·¥å…·ä»…ä¾›å­¦ä¹ ç ”ç©¶
2. **ä¸è¦é¢‘ç¹å‘é€** - é¿å…è¢«å¾®ä¿¡æ£€æµ‹ä¸ºå¼‚å¸¸è¡Œä¸º
3. **ä¿æŒæ‰‹æœºè§£é”** - é”å±æ—¶æ— æ³•æ“ä½œ
4. **ç¨³å®šçš„ USB è¿æ¥** - æ–­å¼€è¿æ¥ä¼šå¯¼è‡´æ“ä½œå¤±è´¥
5. **å¤‡ä»½æ•°æ®** - æ“ä½œå‰å»ºè®®å¤‡ä»½é‡è¦èŠå¤©è®°å½•

## ğŸ“ æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜è¯·æ£€æŸ¥ï¼š
1. æˆªå›¾ç›®å½•ä¸­çš„å›¾ç‰‡ï¼Œç¡®è®¤æ“ä½œæ­¥éª¤
2. ç»ˆç«¯è¾“å‡ºçš„é”™è¯¯ä¿¡æ¯
3. æ‰‹æœºæ˜¯å¦ä¿æŒè¿æ¥å’Œè§£é”çŠ¶æ€

---

**ç‰ˆæœ¬**: 1.0.0  
**æµ‹è¯•ç¯å¢ƒ**: macOS + Redmi (Android 15) + WeChat 8.0.66  
**æœ€åæ›´æ–°**: 2025-12-16
